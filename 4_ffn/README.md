# 前馈神经网络
`整个网络中的信息单向传播, 可以用一个有向无环图表示`

## 1 神经元
> 观察梯度消失问题
>
>死亡ReLU问题

<div>
    <img src="https://camo.githubusercontent.com/e280766d757a0b8b7a7606c5243843c26f37a19b8b1e6f6628df9b84a9934e4a/68747470733a2f2f61692d73747564696f2d7374617469632d6f6e6c696e652e63646e2e626365626f732e636f6d2f30616538373735653932613034313733393238623465336665643938623539333466306161643635383264633431343362323230353636396266616536623535" alt="前馈神经网络" width="700">
</div>

<div style="background-color: white; display: inline-block; padding: 10px;">
    <img src="https://camo.githubusercontent.com/d9a85bf5adee24a9ac8c0c887181cbd87c71dc6d99bd7923f132e645c8b223d0/68747470733a2f2f61692d73747564696f2d7374617469632d6f6e6c696e652e63646e2e626365626f732e636f6d2f64303834623565396538363534333637616234616630343631383466326632393466383561343834313765363465333661373964663934326435643666663638" alt="神经元" width="700">
</div>

## 2 净活性值

$\boldsymbol{X}\in \mathbb{R}^{N \times D}$, `权重向量` $\boldsymbol{W}\in \mathbb{R}^{D \times C}$, `偏置项` $\boldsymbol{b}\in \mathbb{R}^{1 \times C}$

### 🧠 为什么是 `[1, C]` 而不是 `[C, 1]`？

因为：

* 矩阵加法要求 **对应维度相同或可广播**
* 输出 `z` 的形状是 `[N, C]`
* `[1, C]` 会在第 0 维（样本维度）上广播成 `[N, C]`
* 但 `[C, 1]` 无法正确广播成 `[N, C]`，会导致维度不匹配

## 3 激活函数
> 净活性值 $z$ 再经过一个非线性函数 $f(·)$ 后，得到神经元的活性值 $a$
>
> 激活函数通常为非线性函数,可以增强神经网络的表示能力和学习能力.常用的激活函数有S型函数和ReLU函数

### 3.1 Sigmoid 型函数
`Sigmoid 型函数是指一类S型曲线函数,为两端饱和函数,常用的 Sigmoid 型函数有 Logistic 函数和 Tanh 函数`

$$
\sigma(z) = \frac{1}{1+\exp(-z)}
$$

$$
\mathrm{tanh}(z) = \frac{\exp(z)-\exp(-z)}{\exp(z)+\exp(-z)}
$$

<div>
    <img src="data:image/png;base64,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iBEjSE1N5c9//nOrOlu2bCE8PNzz8/3973/v9bjg7D8XpRR33XUXSUlJpKWlsWvXLq/H9NVXX3neh/T0dMLCwnjmmWda1Omu92vevHnExMQwcuRIz7aqqioyMzNJTk4mMzOT6urqNvddsWIFycnJJCcne25On7eO9m2oDvQh79u3Tx04cED96Ec/Up999pln+969e1VaWpqyWq3q8OHDKiEhQTmdzlb7//jHP1arVq1SSil12223qb/97W/n1FnTUffcc496+OGH2ywbPHiwKi8v9+r5T/Xggw+qJ5988ox1nE6nSkhIUIcOHVI2m02lpaWpvXv3ejWuDRs2KIfDoZRS6v7771f3339/m/W64/06/fovGmNRx1/6QFn3HPUMS3r22WfVbbfdppRSatWqVeqGG27wakxKKVVSUqJ27typlFKqtrZWJScnt/q5vPfee+rKK6/0eiynO9vP5T//+Y+6/PLLldvtVlu3blUXXXRRN0bX/DPt37+/KigoaLG9u96v999/X+3cuVOlpqZ6tt13331qyZIlSimllixZ0uZnvrKyUg0dOlRVVlaqqqoqNXToUFVVVXWmU3X/sLfhw4eTkpLSant7j8Ke/h/Du+++y8yZMwGYO3cua9as6crwWp3v9ddfZ/bs2V47R1c79XFkPz8/z+PI3jR16lQMhubBOOPHj6eoqMir5zuT06///91wIwetFej7nZxQaO3atcydOxdofhz7nXfeOfmovpfExcUxZkzz1J+hoaEMHz78jE8W+pK1a9dy8803o2ka48ePp6amhtLS0m47/zvvvENiYqLnAaLudtlll3keQDrh1M9Qe3low4YNZGZmEhkZSUREBJmZmeTl5Z13PN3Sh9zWY7Snf2ArKysxmUyef/xne1z2fH344Yf079+f5OTkNss1TWPq1KmMHTuWnJwcr8VxqmXLlpGWlsa8efPa/DWpI++jN7300ktMnz69zbLueL9Ov/7IAf15ae87LRY1be9x7O5SUFDA7t27GTduXKuyrVu3Mnr0aKZPn87evXu7JZ6z/Vx6+jOVm5vbbqOoJ94vgLKyMuLimpcmi42NpaysrFUdb71vnR6HPGXKFI4dO9Zq+2OPPcY111xz3gF1hY7EuGrVqjO2jj/66CPMZjPffvstmZmZXHDBBVx22WVei+v2229n0aJFaJrGokWLuPfee3np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", alt="Sigmoid型函数", width="600">
</div>

```python
%matplotlib inline
import matplotlib.pyplot as plt

# Logistic函数
def logistic(z):
    return 1.0 / (1.0 + paddle.exp(-z))

# Tanh函数
def tanh(z):
    return (paddle.exp(z) - paddle.exp(-z)) / (paddle.exp(z) + paddle.exp(-z))

# 在[-10,10]的范围内生成10000个输入值，用于绘制函数曲线
z = paddle.linspace(-10, 10, 10000)

plt.figure()
plt.plot(z.tolist(), logistic(z).tolist(), color='#e4007f', label="Logistic Function")
plt.plot(z.tolist(), tanh(z).tolist(), color='#f19ec2', linestyle ='--', label="Tanh Function")

ax = plt.gca() # 获取轴，默认有4个
# 隐藏两个轴，通过把颜色设置成none
ax.spines['top'].set_color('none')
ax.spines['right'].set_color('none')
# 调整坐标轴位置   
ax.spines['left'].set_position(('data',0))
ax.spines['bottom'].set_position(('data',0))
plt.legend(loc='lower right', fontsize='large')

plt.savefig('fw-logistic-tanh.pdf')
plt.show()

```
### 3.2 ReLU型函数
$$
\mathrm{ReLU}(z) = \max(0,z)
$$

$$
\mathrm{LeakyReLU}(z) = \max(0,z)+\lambda \min(0,z)
$$

其中为 $\lambda$ 超参数

```python
# ReLU
def relu(z):
    return paddle.maximum(z, paddle.to_tensor(0.))

# 带泄露的ReLU
def leaky_relu(z, negative_slope=0.1):
    # 当前版本paddle暂不支持直接将bool类型转成int类型，因此调用了paddle的cast函数来进行显式转换
    a1 = (paddle.cast((z > 0), dtype='float32') * z) 
    a2 = (paddle.cast((z <= 0), dtype='float32') * (negative_slope * z))
    return a1 + a2

# 在[-10,10]的范围内生成一系列的输入值，用于绘制relu、leaky_relu的函数曲线
z = paddle.linspace(-10, 10, 10000)

plt.figure()
plt.plot(z.tolist(), relu(z).tolist(), color="#e4007f", label="ReLU Function")
plt.plot(z.tolist(), leaky_relu(z).tolist(), color="#f19ec2", linestyle="--", label="LeakyReLU Function")

ax = plt.gca()
ax.spines['top'].set_color('none')
ax.spines['right'].set_color('none')
ax.spines['left'].set_position(('data',0))
ax.spines['bottom'].set_position(('data',0))
plt.legend(loc='upper left', fontsize='large')
plt.savefig('fw-relu-leakyrelu.pdf')
plt.show()
```

<div>
    <img src="data:image/png;base64,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" alt="ReLU型函数" width="800">
</div>

## 4 构建模型

## 5 模型优化
`神经网络的参数主要是通过`$梯度下降法$`进行优化的, 因此需要计算最终损失对每个参数的梯度. 由于神经网络的层数通常比较深, 其梯度计算和上一章中的线性分类模型的不同的点在于: 线性模型通常比较简单可以直接计算梯度, 而神经网络相当于一个复合函数, 需要利用链式法则进行反向传播来计算梯度`

### 5.1 反向传播算法
神经网络的参数主要是通过 **梯度下降法** 进行优化的, 因此需要计算最终损失对每个参数的梯度. 由于神经网络的层数通常比较深, 其梯度计算和上一章中的线性分类模型的不同的点在于: 线性模型通常比较简单可以直接计算梯度, 而神经网络相当于一个复合函数, 需要利用链式法则进行反向传播来计算梯度

> 前馈神经网络的参数梯度通常使用 **误差反向传播** 算法来计算, 使用误差反向传播算法的前馈神经网络训练过程可以分为以下三步:

1. 前馈计算每一层的净活性值 $\boldsymbol{Z}^{(l)}$ 和激活值 $\boldsymbol{A}^ {(l)}$, 直到最后一层
2. 反向传播计算每一层的误差项 $\delta^{(l)}=\frac{\partial R}{\partial \boldsymbol{Z}^{(l)}}$
3. 计算每一层参数的梯度, 并更新参数

> 在上面实现算子的基础上, 来实现误差反向传播算法, 在上面的三个步骤中

1. 第1步是前向计算,可以利用算子的forward()方法来实现
2. 第2步是反向计算梯度，可以利用算子的backward()方法来实现
3. 第3步中的计算参数梯度也放到backward()中实现,更新参数放到另外的优化器中专门进行

> 这样,在模型训练过程中,我们首先执行模型的forward(),再执行模型的backward(),就得到了所有参数的梯度,之后再利用优化器迭代更新参数

以这我们这节中构建的两层全连接前馈神经网络Model_MLP_L2为例,下图给出了其前向和反向计算过程:

<div>
    <img src="https://camo.githubusercontent.com/9ad099e6a7a3b65a283449bdf122dd6e6264a4c16147eaddb3458f6815d0c6ff/68747470733a2f2f61692d73747564696f2d7374617469632d6f6e6c696e652e63646e2e626365626f732e636f6d2f38353632646662313064343634333936393438643035656533363230636563316430353730323564646465653433666639326461653366626237326538663635" alt="前向和反向计算" width="1200">
</div>

> 下面我们按照反向的梯度传播顺序, 为每个算子添加backward()方法, 并在其中实现每一层参数的梯度的计算

### 5.2 损失函数
> 二分类交叉熵损失函数对神经网络的输出 $\hat{\boldsymbol{y}}$ 的偏导数为:

$$
\frac{\partial R}{\partial \hat{\boldsymbol{y}}}
=  -\frac{1}{N}(\mathrm{dialog}(\frac{1}{\hat{\boldsymbol{y}}})\boldsymbol{y}-\mathrm{dialog}(\frac{1}{1-\hat{\boldsymbol{y}}})(1-\boldsymbol{y})) \\ 
= -\frac{1}{N}(\frac{1}{\hat{\boldsymbol{y}}}\odot\boldsymbol{y}-\frac{1}{1-\hat{\boldsymbol{y}}}\odot(1-\boldsymbol{y}))
$$

> 其中 $dialog(\boldsymbol{x})$ 表示以向量 $x$ 为对角元素的对角阵, $\frac{1}{\boldsymbol{x}}=\frac{1}{x_1},...,\frac{1}{x_N}$ 表示逐元素除, $\odot$ 表示逐元素积

> 实现损失函数的backward()

# 激活函数的选择

非常好的问题 👍，你提到的这个点其实涉及 **Sigmoid / Logistic 函数的数学作用** 和 **模型训练的稳定性**，我来帮你拆开讲清楚。

---

## 🧩 一、先明确 Logit / Logistic 的定义

Logistic（即 Sigmoid）函数：
[
\sigma(x) = \frac{1}{1 + e^{-x}}
]
它的作用有两个核心点：

1. **把任意实数映射到 (0,1)** 区间
   → 方便解释为“概率”

2. **引入非线性**
   → 使模型能学习复杂的非线性边界，而不仅是线性可分。

---

## 🧠 二、不是所有任务都该用 Logistic

你提到的形式：
[
X[N,D],; W[D,C],; b[C]
]
这是一个 **多分类线性层** 的典型结构。
对这种输出，通常不会直接用 Sigmoid，而是：

| 情况               | 激活函数      | 目的                   |
| ---------------- | --------- | -------------------- |
| 二分类（C=1 或 C=2）   | ✅ Sigmoid | 把 logit 映射到 [0,1] 概率 |
| 多分类（C>2）         | ✅ Softmax | 把每个类别得分转为概率分布（和为1）   |
| 多标签（multi-label） | ✅ Sigmoid | 每个类别独立判断是否属于该类       |

---

## 💡 三、Sigmoid 是否为了“防梯度爆炸”？

部分对 ✅，但不是它的主要目的。

我们可以这样区分：

| 作用类型           | 是否成立 | 解释                                  |
| -------------- | ---- | ----------------------------------- |
| ✅ 数值缩放（限制输出范围） | ✔️   | 确实让输出不至于无限大或无限小                     |
| ✅ 稳定梯度（部分正确）   | ⚠️   | 它**并不是专门为防梯度爆炸设计的**，反而在极端情况下会导致梯度消失 |
| ❌ 仅仅为了缩放数值     | ❌    | 它的主要作用是**产生概率解释**和**引入非线性**         |

---

## 📉 四、为什么不是防梯度爆炸？

我们看看 Sigmoid 的导数：
[
\sigma'(x) = \sigma(x)(1 - \sigma(x))
]

当 (x) 很大时，(\sigma(x) \to 1)，导数 → 0
当 (x) 很小时，(\sigma(x) \to 0)，导数 → 0

👉 所以它其实会导致 **梯度消失（vanishing gradient）**，而不是防梯度爆炸。

这也是为什么在深层网络中（尤其是大模型中），我们更倾向于使用：

* **ReLU / GELU / SiLU** 这类激活函数；
* 在最后一层根据任务类型再使用 **Sigmoid / Softmax** 来产生概率。

---

## 🔸 五、总结一句话

> Logistic 函数的主要作用是：
>
> * 把线性输出映射到 (0,1) 概率空间；
> * 为模型引入非线性；
> * 而不是为了防梯度爆炸（实际上它可能导致梯度消失）。

---

如果你想，我可以帮你画一张图，
展示一下从 `线性输出 Z → Sigmoid → 反向传播梯度变化` 的全过程，
包括梯度在不同输入区间的衰减（可视化曲线）。

要我画这张图吗？


# 误差反向传播 和 梯度下降的比较

非常核心的问题 👍
几乎所有深度学习算法的本质，都可以用这两个概念解释清楚：
**「误差反向传播（Backpropagation）」** 和 **「梯度下降（Gradient Descent）」**。
它们关系紧密，但职责不同。我们来一点点拆解 👇

---

## 🧠 一、它们分别是什么

### 1️⃣ 误差反向传播（Backpropagation, 简称 **BP算法**）

**作用：**
计算每个参数的 **梯度**（即损失函数对参数的偏导数）。

通俗点讲：

> “反向传播 = 算出每个权重该怎么改。”

数学上：
[
\frac{\partial L}{\partial W}, \quad \frac{\partial L}{\partial b}
]
都是反向传播的结果。

💬 举例：
假设网络：
[
y = f(x; W, b)
]
损失函数：
[
L = \text{Loss}(y, y_{true})
]
BP算法会计算出：
[
\frac{\partial L}{\partial W}, \frac{\partial L}{\partial b}
]

---

### 2️⃣ 梯度下降（Gradient Descent）

**作用：**
用上面算出的梯度，**更新参数**，让损失变小。

通俗点讲：

> “梯度下降 = 按梯度的反方向走一步。”

公式：
[
W := W - \eta \frac{\partial L}{\partial W}
]
[
b := b - \eta \frac{\partial L}{\partial b}
]
其中 (\eta) 是学习率（learning rate）。

---

## 🔁 二、它们的关系

可以这样理解：

| 阶段   | 名称               | 主要任务                | 举例                         |
| ---- | ---------------- | ------------------- | -------------------------- |
| 向前传播 | Forward pass     | 计算预测输出 (y)，得到损失 (L) | `L = loss(y_pred, y_true)` |
| 反向传播 | Backpropagation  | 计算每个参数的梯度           | `L.backward()`             |
| 参数更新 | Gradient Descent | 用梯度更新参数             | `optimizer.step()`         |

🧩 一句话概括：

> **反向传播负责“算梯度”，梯度下降负责“用梯度更新参数”。**

---

## 💡 三、打个比喻：

假设你要下山（找到最低的损失值）：

* **反向传播（Backpropagation）**：
  告诉你“往哪个方向走最陡峭”（计算坡度/梯度）。
* **梯度下降（Gradient Descent）**：
  你真的朝那个方向走一步（更新参数）。

---

## ⚙️ 四、在 PyTorch 中的体现

```python
# 1. 前向传播
outputs = model(inputs)
loss = criterion(outputs, targets)

# 2. 反向传播：计算梯度
loss.backward()

# 3. 梯度下降：更新参数
optimizer.step()
optimizer.zero_grad()  # 清空上一步的梯度
```

---

## ✅ 总结表格

| 对比项    | 误差反向传播 (Backprop) | 梯度下降 (Gradient Descent) |
| ------ | ----------------- | ----------------------- |
| 作用     | 计算梯度              | 更新参数                    |
| 输入     | 当前的损失函数           | 反向传播得到的梯度               |
| 输出     | 每个参数的梯度           | 新的参数值                   |
| 是否修改参数 | ❌ 否               | ✅ 是                     |
| 实现形式   | `loss.backward()` | `optimizer.step()`      |

---

要不要我帮你画一张图（前向传播 → 反向传播 → 梯度更新）流程图？
能更直观看出这两个概念的区别与衔接

# logistic 什么时候使用 backward() 传递梯度, 什么时候不使用

非常棒的延伸问题 👍

你已经理解到关键点了：
`Logistic`（sigmoid）确实有时候 **需要 backward**，有时候 **不需要 backward**。
下面我们来区分这两种情况，让你清楚什么时候要写 `backward()`，什么时候不需要。

---

## 🧩 一、什么时候需要 `backward()`

> 当 **sigmoid 是网络中间的一层激活函数** 时，你就必须定义 `backward()`。

也就是：

* 你的网络是自己实现的计算图（比如你在写一个 `Op` 系统）；
* sigmoid 的输出会传给后续层；
* 你要通过链式法则向前一层传递梯度。

举例：

```python
x -> Linear -> Logistic -> Linear -> Loss
```

在这种情况下：

* 误差从 `Loss` 反向传来；
* 传到 `Logistic.backward()`；
* 它需要计算当前层输入的梯度，才能继续传给 `Linear.backward()`。

✅ 所以必须定义：

```python
grad_inputs = grad_outputs * self.outputs * (1 - self.outputs)
```

---

## 🧠 二、什么时候 *不需要* backward

有两种常见情况：

---

### ✅ 情况 1：**Logistic 仅用于最终输出层（预测阶段 / 推理阶段）**

也就是：

* 你只是想得到概率；
* 不再训练；
* 不需要反向传播。

比如：

```python
logits = model(x)
probs = sigmoid(logits)   # 仅仅为了得到概率结果
preds = (probs > 0.5).int()
```

此时：

* 你不会计算 loss.backward()
* 不需要梯度；
* 所以根本不必实现 backward。

🟢 换句话说：

> **推理阶段（inference）不需要 backward。**

---

### ✅ 情况 2：**你使用了 PyTorch 内置的 autograd**

比如：

```python
import torch
import torch.nn.functional as F

x = torch.randn(4, requires_grad=True)
y = torch.sigmoid(x)
y.sum().backward()
```

此时：

* `torch.sigmoid` 已经自动注册了梯度；
* PyTorch 的自动求导机制会自动帮你算出：
  [
  \frac{dy}{dx} = y(1 - y)
  ]
* 你完全不需要自己实现 `backward()`。

🟢 换句话说：

> **当你使用 PyTorch 的 autograd（或 TensorFlow 的计算图）时，不需要自己写 backward。**

---

### ✅ 情况 3（进阶）：**Loss 函数内部已经包含 sigmoid**

例如：

```python
loss = torch.nn.BCEWithLogitsLoss()
```

这个损失函数**内部**已经做了 sigmoid：
[
\text{BCEWithLogitsLoss}(x, y) = \text{BCE}(\sigma(x), y)
]

所以你在模型里不需要再写 Logistic 层，否则会重复：

```python
# ❌ 不要这样
out = sigmoid(linear(x))
loss = BCEWithLogitsLoss(out, y)  # 再次 sigmoid 会出错
```

🟢 正确做法：

```python
# ✅ 直接输出 logits
out = linear(x)
loss = BCEWithLogitsLoss(out, y)
```

这时候也完全不需要写 `backward()`，因为 PyTorch 内部都处理好了。

---

## 🎯 总结

| 场景                   | 是否需要实现 `backward()` | 原因            |
| -------------------- | ------------------- | ------------- |
| 自己实现计算图（手写反向传播）      | ✅ 是                 | 必须手动计算链式梯度    |
| PyTorch 内置 autograd  | ❌ 否                 | 框架自动计算        |
| 推理阶段（不训练）            | ❌ 否                 | 不计算梯度         |
| 使用 BCEWithLogitsLoss | ❌ 否                 | 已包含 sigmoid   |
| 模型最后一层只是为了输出概率       | ❌ 否                 | 只需 forward 即可 |

---

要我帮你画一张图，展示这几种“需要/不需要 backward”的典型网络结构对比图吗？
一张图看完你就能完全区分清楚。


# 二分类交叉熵求梯度

非常好的问题，这其实是**二分类交叉熵（Binary Cross Entropy, BCE）损失函数的梯度推导**核心部分。我们来一步步看清楚为什么它会变成你写的这个形式。

---

## 🌱 一、损失函数定义

对于二分类问题（如 Logistic 回归），我们有预测概率：
[
\hat{y}_i = \sigma(z_i) = \frac{1}{1+e^{-z_i}}
]
真实标签：
[
y_i \in {0,1}
]

交叉熵损失（平均形式）是：
[
R = -\frac{1}{N} \sum_{i=1}^N \left[ y_i \ln(\hat{y}_i) + (1 - y_i) \ln(1 - \hat{y}_i) \right]
]

---

## 🌿 二、对预测输出求偏导

我们想要求：
[
\frac{\partial R}{\partial \hat{y}_i}
]

代入定义：
[
R_i = -\left[ y_i \ln(\hat{y}_i) + (1 - y_i) \ln(1 - \hat{y}_i) \right]
]

对 (\hat{y}_i) 求导：

[
\frac{\partial R_i}{\partial \hat{y}_i}
= -\left[ \frac{y_i}{\hat{y}_i} - \frac{1 - y_i}{1 - \hat{y}_i} \right]
]

整理符号（负号分配）：
[
\frac{\partial R_i}{\partial \hat{y}_i}
= -\frac{y_i}{\hat{y}_i} + \frac{1 - y_i}{1 - \hat{y}_i}
]

---

## 🌾 三、写成向量形式

对整个 batch（大小为 (N)）写成向量形式：

[
\frac{\partial R}{\partial \hat{\boldsymbol{y}}}
= -\frac{1}{N}\left( \frac{\boldsymbol{y}}{\hat{\boldsymbol{y}}} - \frac{1 - \boldsymbol{y}}{1 - \hat{\boldsymbol{y}}} \right)
]

其中除法是逐元素（element-wise）运算，也可以写成 Hadamard 乘积（(\odot)）的形式：

[
\frac{\partial R}{\partial \hat{\boldsymbol{y}}}
= -\frac{1}{N}\left( \frac{1}{\hat{\boldsymbol{y}}} \odot \boldsymbol{y}

* \frac{1}{1 - \hat{\boldsymbol{y}}} \odot (1 - \boldsymbol{y}) \right)
  ]

如果你用矩阵符号表示，可以用对角矩阵 `diag()` 写成：
[
-\frac{1}{N}\left(
\mathrm{diag}\left(\frac{1}{\hat{\boldsymbol{y}}}\right)\boldsymbol{y}
----------------------------------------------------------------------

\mathrm{diag}\left(\frac{1}{1 - \hat{\boldsymbol{y}}}\right)(1 - \boldsymbol{y})
\right)
]

---

## 🌻 四、直觉解释

* 第一项 (\frac{y}{\hat{y}})：当真实为1时，希望 (\hat{y}) 大一点；
* 第二项 (\frac{1 - y}{1 - \hat{y}})：当真实为0时，希望 (\hat{y}) 小一点；
* 负号体现了梯度下降的方向（因为我们要**最小化**损失函数）。

---

## 🌸 五、进一步简化（常见形式）

如果你后面还要继续链式求导（比如对 logit (z) 求导），会得到非常漂亮的结果：

[
\frac{\partial R}{\partial z_i} = \hat{y}_i - y_i
]

这是因为：
[
\frac{\partial R}{\partial \hat{y}_i} \cdot \frac{\partial \hat{y}_i}{\partial z_i}
= \left(-\frac{y_i}{\hat{y}_i} + \frac{1 - y_i}{1 - \hat{y}_i}\right) \cdot \hat{y}_i (1 - \hat{y}_i)
= \hat{y}_i - y_i
]

这就是为什么在实现 Logistic 回归反向传播时，**梯度结果非常简洁**的原因。

---

是否希望我接着帮你画一个这个推导的流程图（从 (R) → (\hat{y}) → (z)）？
那样你会更直观看清梯度是怎么一路传下来的。

# 1e-8 保证精度, 更大或者更小不好吗

非常好的问题 👍
你提到的 `1e-8`（也就是 (10^{-8})）在机器学习代码中经常出现，比如：

```python
eps = 1e-8
torch.log(x + eps)
```

它不是一个神秘的数字，而是 **一种数值稳定性平衡点**。下面我们详细解释为什么选它、太大或太小会怎样 👇

---

## 💡 一、为什么需要加 eps？

在计算交叉熵时，我们要计算：
[
\log(\hat{y}), \quad \log(1 - \hat{y})
]
但由于浮点数运算中，模型的预测 (\hat{y}) 可能非常接近 0 或 1，比如：
[
\hat{y} = 1.00000000 \text{ 或 } 0.00000001
]
这时：

* (\log(0)) → 负无穷，计算直接崩溃；
* 除以 0 → `NaN`；
* 导致梯度爆炸，训练不稳定。

所以，我们加一个很小的数 `eps` 来“垫底”，防止数值进入非法区域：
[
\log(\hat{y} + \varepsilon)
\quad\text{和}\quad
\log(1 - \hat{y} + \varepsilon)
]

---

## ⚖️ 二、为什么恰好选 1e-8？

这个值是实践经验与浮点精度权衡的结果。

| eps          | 效果                    | 说明               |
| ------------ | --------------------- | ---------------- |
| **1e-16**    | 太小，仍可能在 `float32` 下溢出 | 可能被视为 0（数值精度不足）  |
| **1e-12**    | 较安全，但仍可能在极端梯度下不稳      |                  |
| **1e-8**     | ✅ 最常用的折中值，兼顾稳定与准确     | 几乎不会对数值结果造成偏差    |
| **1e-4 或更大** | 太大，会改变损失值分布           | 对梯度方向产生明显影响，影响收敛 |

简而言之：

> * 太小 → 不能有效防止数值下溢。
> * 太大 → 会**人为扭曲损失函数**（因为你实际上计算的是 log(y + 1e-4) 而非 log(y)）。

---

## 🧮 三、一个简单例子

假设模型输出：

```python
y_hat = torch.tensor([1e-8])
```

* 如果不加 eps：

  ```python
  torch.log(y_hat) = -18.4207
  ```

  在反向传播中梯度巨大，可能爆炸。
* 如果加 `1e-8`：

  ```python
  torch.log(y_hat + 1e-8) = -18.4207
  ```

  几乎一样，但保证了安全；
* 如果加 `1e-4`：

  ```python
  torch.log(y_hat + 1e-4) = -9.2103
  ```

  损失明显变小，梯度方向偏了。

---

## ✅ 四、结论

| 项目           | 推荐值               | 原因                             |
| ------------ | ----------------- | ------------------------------ |
| eps（float32） | `1e-8`            | 兼顾稳定性与数值精度                     |
| eps（float64） | `1e-12` 或 `1e-16` | 双精度可承受更小值                      |
| 深度学习常用标准     | **1e-8**          | PyTorch、TensorFlow、Adam优化器等均默认 |

---

如果你愿意，我可以展示一个实际小实验：
对比 `eps=1e-8`、`eps=1e-4`、`eps=1e-12` 对梯度数值和损失值的影响，用图或代码输出。是否要我帮你展示？
